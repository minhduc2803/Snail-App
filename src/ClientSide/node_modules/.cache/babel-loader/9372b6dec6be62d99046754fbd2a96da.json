{"ast":null,"code":"import _regeneratorRuntime from \"/home/minhduc/vng/module-11/fresher-program-2020/submissions/module-11/ducnm8/src/clientSide/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/minhduc/vng/module-11/fresher-program-2020/submissions/module-11/ducnm8/src/clientSide/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/minhduc/vng/module-11/fresher-program-2020/submissions/module-11/ducnm8/src/clientSide/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/minhduc/vng/module-11/fresher-program-2020/submissions/module-11/ducnm8/src/clientSide/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/minhduc/vng/module-11/fresher-program-2020/submissions/module-11/ducnm8/src/clientSide/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/minhduc/vng/module-11/fresher-program-2020/submissions/module-11/ducnm8/src/clientSide/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/minhduc/vng/module-11/fresher-program-2020/submissions/module-11/ducnm8/src/clientSide/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/minhduc/vng/module-11/fresher-program-2020/submissions/module-11/ducnm8/src/clientSide/src/components/Messenger/index.js\";\nimport React from 'react';\nimport ConversationList from '../ConversationList';\nimport MessageList from '../MessageList';\nimport './Messenger.css';\nimport Toolbar from '../Toolbar';\nimport ToolbarButton from '../ToolbarButton';\nimport axios from 'axios';\n\nvar Messenger =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Messenger, _React$Component);\n\n  function Messenger(props) {\n    var _this;\n\n    _classCallCheck(this, Messenger);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Messenger).call(this, props));\n    _this.state = {\n      user: props.user\n    };\n    return _this;\n  }\n\n  _createClass(Messenger, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      console.log(this.props.user);\n      var conversationList;\n      var allChatList = [];\n      axios({\n        method: 'get',\n        url: 'http://localhost:8055/api/protected/list-user',\n        headers: {\n          Authorization: 'Bearer ' + this.state.user.Token\n        }\n      }).then(function (response) {\n        console.log(response);\n        conversationList = response.data.data.map(function (result) {\n          console.log(result);\n          return {\n            photo: '#',\n            name: \"\".concat(result.Fullname),\n            text: '',\n            Token: _this2.state.user.Token,\n            UserID: _this2.state.user.UserID\n          };\n        });\n        return conversationList;\n      }).then(\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee(response) {\n          var conversation, chatList;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.t0 = _regeneratorRuntime.keys(response);\n\n                case 1:\n                  if ((_context.t1 = _context.t0()).done) {\n                    _context.next = 8;\n                    break;\n                  }\n\n                  conversation = _context.t1.value;\n                  _context.next = 5;\n                  return axios({\n                    method: 'get',\n                    url: 'http://localhost:8055/api/protected/list-chat',\n                    headers: {\n                      Authorization: 'Bearer ' + _this2.state.user.Token\n                    }\n                  });\n\n                case 5:\n                  chatList = _context.sent;\n                  _context.next = 1;\n                  break;\n\n                case 8:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n      var ws = new WebSocket(\"ws://localhost:9009/chat?token=\" + this.props.user.token);\n\n      ws.onopen = function () {\n        console.log(\"websocket connected\");\n      };\n\n      ws.onmessage = function (chat) {};\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"messenger\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }, React.createElement(Toolbar, {\n        title: \"Messenger\",\n        leftItems: [React.createElement(ToolbarButton, {\n          key: \"cog\",\n          icon: \"ion-ios-cog\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72\n          },\n          __self: this\n        })],\n        rightItems: [React.createElement(ToolbarButton, {\n          key: \"add\",\n          icon: \"ion-ios-add-circle-outline\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 75\n          },\n          __self: this\n        })],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }), React.createElement(Toolbar, {\n        title: \"Conversation Title\",\n        rightItems: [React.createElement(ToolbarButton, {\n          key: \"info\",\n          icon: \"ion-ios-information-circle-outline\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 82\n          },\n          __self: this\n        }), React.createElement(ToolbarButton, {\n          key: \"video\",\n          icon: \"ion-ios-videocam\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 83\n          },\n          __self: this\n        }), React.createElement(ToolbarButton, {\n          key: \"phone\",\n          icon: \"ion-ios-call\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        })],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"scrollable sidebar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, React.createElement(ConversationList, {\n        user: this.state.user,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"scrollable content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }, React.createElement(MessageList, {\n        user: this.state.user,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Messenger;\n}(React.Component);\n\nexport { Messenger as default };","map":{"version":3,"sources":["/home/minhduc/vng/module-11/fresher-program-2020/submissions/module-11/ducnm8/src/clientSide/src/components/Messenger/index.js"],"names":["React","ConversationList","MessageList","Toolbar","ToolbarButton","axios","Messenger","props","state","user","console","log","conversationList","allChatList","method","url","headers","Authorization","Token","then","response","data","map","result","photo","name","Fullname","text","UserID","conversation","chatList","ws","WebSocket","token","onopen","onmessage","chat","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ConversationList from '../ConversationList';\nimport MessageList from '../MessageList';\nimport './Messenger.css';\nimport Toolbar from '../Toolbar';\nimport ToolbarButton from '../ToolbarButton'\nimport axios from 'axios';\n\nexport default class Messenger extends React.Component {\n  constructor(props){\n    super(props);\n    \n    \n    this.state = {\n      user: props.user,\n      \n    }\n  }\n\n  componentDidMount(){\n    console.log(this.props.user);\n\n    var conversationList;\n    var allChatList = []\n    axios({\n      method: 'get',\n      url: 'http://localhost:8055/api/protected/list-user',\n      headers: {Authorization: 'Bearer '+this.state.user.Token}\n    }).then(response => {\n        console.log(response);\n        conversationList = response.data.data.map(result => {\n          console.log(result);\n          return {\n            photo: '#',\n            name: `${result.Fullname}`,\n            text: '',\n            Token: this.state.user.Token,\n            UserID: this.state.user.UserID\n          };\n        });\n        \n        return conversationList;\n    }).then(async response => {\n\n        var conversation;\n        \n        for(conversation in response){\n            let chatList = await axios({\n              method: 'get',\n              url: 'http://localhost:8055/api/protected/list-chat',\n              headers: {Authorization: 'Bearer '+this.state.user.Token}\n            })\n        }\n    });\n\n    var ws = new WebSocket(\"ws://localhost:9009/chat?token=\"+this.props.user.token);\n    ws.onopen = () => {\n      console.log(\"websocket connected\");\n    }\n\n    ws.onmessage = (chat) => {\n\n    }\n  }\n\n  render(){\n        return (\n          <div className=\"messenger\">\n            { <Toolbar\n              title=\"Messenger\"\n              leftItems={[\n                <ToolbarButton key=\"cog\" icon=\"ion-ios-cog\" />\n              ]}\n              rightItems={[\n                <ToolbarButton key=\"add\" icon=\"ion-ios-add-circle-outline\" />\n              ]}\n            /> }\n\n            { <Toolbar\n              title=\"Conversation Title\"\n              rightItems={[\n                <ToolbarButton key=\"info\" icon=\"ion-ios-information-circle-outline\" />,\n                <ToolbarButton key=\"video\" icon=\"ion-ios-videocam\" />,\n                <ToolbarButton key=\"phone\" icon=\"ion-ios-call\" />\n              ]}\n            /> }\n\n            <div className=\"scrollable sidebar\">\n              <ConversationList user={this.state.user}/>\n            </div>\n\n            <div className=\"scrollable content\">\n              <MessageList user={this.state.user}/>\n            </div>\n          </div>\n        );\n      }\n}"]},"metadata":{},"sourceType":"module"}